# SeniorSeminar

Overview
---------

This is a project in Unreal Engine 4, C++, and Android.  It has three parts: The Unreal Engine project (referred to as UE4 project), the C++ neural network program (referred to as Independent NN), and the Android project (referred to as Phone Controller).

Functionality
-------------

The UE4 project receives phone and joystick data from the Phone Controller in the form of strings.  It then parses these strings into useable data that is then used by the UE4 project.

The UE4 project also has a second functionality, activated by pressing ‘r’ while the program is running.  This causes the program to randomly choose a test case to create and activate a 3-second countdown until asking the user to complete the test case.  The user will then be asked to confirm that the requested test case has been created, or throw out this test case.  These test cases are saved in a file named TestData.txt, located in the directory set by the SaveDirectory variable in MyPawn.cpp.  The program is currently trained to recognize circles, but could possibly be trained to recognize other gestures.

The Independent NN is a separate Neural Network whose purpose is to test the data gathered by the UE4 project and optionally to save the state of the network after finishing the TestData.  The program looks for a file called TestData.txt in its local directory and reads the configuration of the net from that file, then runs through each test case and adjusts the network.  If the save code is uncommented in IndependentNeuralNetwork.cpp, the network will save the files in a file called savedWeights.txt.

The Phone Controller is an app that is written to provide functionality as a joystick and accelerometer collector.  The Phone Controller uses Wifi to send this data to the UE4 project for use.  The user presses the Wifi button, enters the IP address of the computer the UE4 project is running on, and presses connect.  When done, the user presses the disconnect button to close the connection and exit the app.

Known Issues
---------------

Independent NN
---------------

The TestData.txt file must have the first line be: “topology: x y1 y2 …yn z”, where x y and z are integer values that determine the size and number of layers in the network.  This information is not included when the TestData.txt file is generated by the UE4 project.  The network is currently trained for a “topology: 400 15 1” network, but any size network could be entered in this program.  Currently, 400 is chosen because it is the number of inputs read during the test case generation.  15 is chose arbitrarily, and 1 is chose because I am only interested in two states: not circle and circle (-1 and 1 respectively).

The TrainingData class is defined in the IndependentNeuralNetwork.cpp file instead of the .h file because the code breaks when I move it to the .h file.  I have not been able to put in the time to find the cause of this.

The savedWeights.txt file generated does not include the topology line discussed above.  The line is also needed in the weights file to determine what the topology of the net should be when it is created with set weights.  The formatting is the same as the topology line above.

UE4 Project
-------------

The test case generation portion of this project is only able to generate test cases for networks that have 400 inputs and 1 output.  To change this amount, the user would need to change how many inputs are saved and modify the output to the desired amount.  For example, if I wanted the network to have two outputs, and only one output could be active at a time, the outputs of the test cases should be “-1 -1”, “1 -1”, and “-1 1”.

The weights file must have a topology line as its first line.  See the first paragraph of the above section for details on what this line looks like.  The project relies on this line to determine what the network should look like.

NetworkForController.cpp runs in its own thread.  If the program is halted before this thread receives a disconnect signal from the phone, I do not believe this thread is ever closed.  Or at least, the socket remains open and the thread cannot be restarted statically.  The only fix I have found to get the program to launch normally is to restart the computer.

Phone Controller
---------------

The gravity sensor is collected and sent from the phone, and received and parsed in the UE4 project, but the values are never used.

The new sensor data is not being sent out onSensorChanged, but rather being saved and broadcast by a timer that triggers every 0.01 seconds.  This is done because the sensorData seemed to be blocking the joystick data early in the project, but I never got around to investigating this issue past a simple patch.

Other Issues
-------------

The inputs saved in the UE4 project’s test cases show that only 24 of the 400 input values are unique.  The UE4 project is adding inputs every 0.01 seconds, the NetworkForController thread is listening on the socket in a while loop, the Phone Controller is sending the current saved data every 0.01 seconds, and the accelerometer’s data is being saved onSensorChanged.  I have two theories about this issue: 1) the accelerometer is only reporting 12 sets of data every 2 seconds, which leads to 24 x,z values saved over 2 seconds. 2) the patch I used in the Phone Controller to avoid onSensorChanged blocking the joystick data from being sent is causing much of the sensor data to be lost.
